<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Conflict Patterns</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <div class="container">
        <div class="page-content">
            <h1>Test Monthly Conflict Patterns</h1>
            
            <div class="analytics-card">
                <h3 class="card-title">Conflict Patterns (Last 365 Days)</h3>
                <div id="utilizationHeatmap"></div>
            </div>
        </div>
    </div>

    <script>
        // Mock data for testing
        const mockConflictData = {
            monthlyConflicts: [
                { month: 'Jan', year: 2024, conflicts: 5, label: 'Jan 2024' },
                { month: 'Feb', year: 2024, conflicts: 8, label: 'Feb 2024' },
                { month: 'Mar', year: 2024, conflicts: 3, label: 'Mar 2024' },
                { month: 'Apr', year: 2024, conflicts: 12, label: 'Apr 2024' },
                { month: 'May', year: 2024, conflicts: 7, label: 'May 2024' },
                { month: 'Jun', year: 2024, conflicts: 15, label: 'Jun 2024' },
                { month: 'Jul', year: 2024, conflicts: 9, label: 'Jul 2024' },
                { month: 'Aug', year: 2024, conflicts: 6, label: 'Aug 2024' },
                { month: 'Sep', year: 2024, conflicts: 11, label: 'Sep 2024' },
                { month: 'Oct', year: 2024, conflicts: 4, label: 'Oct 2024' },
                { month: 'Nov', year: 2024, conflicts: 13, label: 'Nov 2024' },
                { month: 'Dec', year: 2024, conflicts: 2, label: 'Dec 2024' }
            ],
            peakMonth: { month: 'Jun', year: 2024, conflicts: 15, label: 'Jun 2024' },
            lowMonth: { month: 'Dec', year: 2024, conflicts: 2, label: 'Dec 2024' },
            totalConflicts: 95
        };

        // Test the display function
        function displayUtilizationHeatmap(conflictData) {
            const container = document.getElementById('utilizationHeatmap');
            if (!container || !conflictData) {
                console.log('Conflict patterns container or data missing:', !!container, !!conflictData);
                return;
            }

            const { monthlyConflicts, peakMonth, lowMonth, totalConflicts } = conflictData;

            let html = '<div class="conflict-patterns-summary">';
            html += '<div class="insight-box">';
            html += '<div class="insight-item">ðŸ“ˆ <strong>Peak:</strong> ' + peakMonth.label + ' (' + peakMonth.conflicts + ' conflicts)</div>';
            html += '<div class="insight-item">ðŸ“‰ <strong>Low:</strong> ' + lowMonth.label + ' (' + lowMonth.conflicts + ' conflicts)</div>';
            html += '<div class="insight-item">ðŸ“Š <strong>Total:</strong> ' + totalConflicts + ' conflicts in last 365 days</div>';
            html += '</div>';
            html += '</div>';

            // Find max conflicts for scaling
            const maxConflicts = Math.max(...monthlyConflicts.map(m => m.conflicts), 1);

            html += '<div class="monthly-chart">';
            monthlyConflicts.forEach(month => {
                const barHeight = Math.max((month.conflicts / maxConflicts) * 100, 5);
                const colorClass = month.conflicts >= maxConflicts * 0.7 ? 'high' : 
                                  month.conflicts >= maxConflicts * 0.4 ? 'medium' : 'low';
                
                html += '<div class="monthly-bar">';
                html += '<div class="bar-container">';
                html += '<div class="bar ' + colorClass + '" style="height: ' + barHeight + '%"></div>';
                html += '</div>';
                html += '<div class="bar-label">' + month.month + '</div>';
                html += '<div class="bar-value">' + month.conflicts + '</div>';
                html += '</div>';
            });
            html += '</div>';

            html += '<div class="chart-note">Shows conflict pairs detected over the last 365 days, independent of selected timeframe</div>';

            container.innerHTML = html;
        }

        // Display the test data
        displayUtilizationHeatmap(mockConflictData);
    </script>
</body>
</html>